<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Status Checker</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,600;1,300&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0d0f14;
            min-height: 100vh;
            padding: 20px;
            color: #c8d0e0;
        }

        .container { max-width: 1200px; margin: 0 auto; }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        header {
            text-align: center;
            margin-bottom: 16px;
            padding: 24px 28px 22px;
            background: linear-gradient(135deg, #13161e 0%, #0e1420 100%);
            border: 1px solid #252a38;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute; inset: 0;
            background: repeating-linear-gradient(0deg, transparent, transparent 39px,
                rgba(79,156,249,0.03) 39px, rgba(79,156,249,0.03) 40px);
            pointer-events: none;
        }
        header > * { position: relative; z-index: 1; }

        h1 {
            font-size: 26px; font-weight: 300; color: #e8edf8;
            letter-spacing: -0.02em; margin-bottom: 8px;
        }
        h1 strong { font-weight: 600; color: #ffffff; }

        .subtitle {
            font-size: 13px; color: #6b7590; margin-bottom: 10px;
        }

        .last-updated {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px; color: #3a4055;
            letter-spacing: 0.06em; margin-top: 10px;
        }

        .refresh-button {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px; font-weight: 600;
            letter-spacing: 0.08em; text-transform: uppercase;
            background: #1a3a6e; color: #4f9cf9;
            border: 1px solid rgba(79,156,249,0.3);
            padding: 8px 18px; border-radius: 5px;
            cursor: pointer; margin-top: 10px;
            transition: background 0.15s, border-color 0.15s;
        }
        .refresh-button:hover {
            background: #1f4580; border-color: rgba(79,156,249,0.5);
        }
        .refresh-button.loading {
            background: #1a1e28; color: #3a4055;
            border-color: #252a38; cursor: not-allowed;
        }

        /* ‚îÄ‚îÄ FETCH NOTE ‚îÄ‚îÄ */
        .fetch-note {
            background: rgba(79,156,249,0.07);
            border: 1px solid rgba(79,156,249,0.15);
            border-radius: 6px;
            color: #6b7590; padding: 12px 16px;
            font-size: 12px; margin-bottom: 16px;
            line-height: 1.6;
            display: flex; gap: 10px; align-items: flex-start;
        }
        .fetch-note::before {
            content: '‚Ñπ'; font-size: 14px; color: #4f9cf9;
            flex-shrink: 0; margin-top: 1px;
        }

        /* ‚îÄ‚îÄ STATS ‚îÄ‚îÄ */
        .stats {
            display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 10px; margin-bottom: 16px;
        }

        .stat-card {
            background: #13161e; border: 1px solid #252a38;
            border-radius: 7px; padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 30px; font-weight: 700; margin-bottom: 8px; line-height: 1;
        }
        .stat-number.working { color: #3ecf8e; }
        .stat-number.issues  { color: #f5a623; }
        .stat-number.down    { color: #f56565; }

        .stat-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 9px; color: #3a4055;
            text-transform: uppercase; letter-spacing: 0.12em;
        }

        /* ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ */
        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .category {
            background: #13161e; border: 1px solid #252a38;
            border-radius: 7px; overflow: hidden;
        }

        .category-title {
            background: #1a1e28; border-bottom: 1px solid #252a38;
            padding: 9px 16px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px; font-weight: 600;
            letter-spacing: 0.08em; text-transform: uppercase; color: #c8d0e0;
        }

        /* ‚îÄ‚îÄ SERVICE ROW ‚îÄ‚îÄ */
        .service {
            display: flex; align-items: center;
            padding: 9px 16px;
            border-bottom: 1px solid #1a1e28;
            text-decoration: none;
            background: transparent;
            transition: background 0.1s;
        }
        .service:last-child { border-bottom: none; }
        .service:hover { background: rgba(79,156,249,0.05); }

        .status-bar {
            width: 3px; height: 28px; border-radius: 2px;
            margin-right: 14px; flex-shrink: 0;
        }
        .status-bar.working  { background: #3ecf8e; box-shadow: 0 0 6px rgba(62,207,142,0.25); }
        .status-bar.issues   { background: #f5a623; box-shadow: 0 0 6px rgba(245,166,35,0.25); }
        .status-bar.down     { background: #f56565; box-shadow: 0 0 6px rgba(245,101,101,0.25); }
        .status-bar.checking { background: #2f3650; animation: pulse 1.5s ease-in-out infinite; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .service-info { flex: 1; min-width: 0; }

        .service-name {
            font-size: 12.5px; font-weight: 600; color: #c8d0e0;
            word-break: break-word; line-height: 1.4;
        }
        .service:hover .service-name { color: #e8edf8; }

        .service-detail {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px; color: #3a4055;
            margin-top: 2px; letter-spacing: 0.02em;
        }

        .status-text {
            margin-left: 10px; flex-shrink: 0;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 9px; font-weight: 700;
            padding: 3px 8px; border-radius: 3px;
            text-transform: uppercase; letter-spacing: 0.06em;
            white-space: nowrap;
        }
        .status-text.working  { color: #3ecf8e; background: rgba(62,207,142,0.1);   border: 1px solid rgba(62,207,142,0.2); }
        .status-text.issues   { color: #f5a623; background: rgba(245,166,35,0.08);  border: 1px solid rgba(245,166,35,0.2); }
        .status-text.down     { color: #f56565; background: rgba(245,101,101,0.08); border: 1px solid rgba(245,101,101,0.2); }
        .status-text.checking { color: #3a4055; background: #1a1e28;               border: 1px solid #252a38; }

        /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
        @media (max-width: 768px) {
            .categories { grid-template-columns: 1fr; }
            .stats { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 480px) {
            .stats { grid-template-columns: 1fr; }
            body { padding: 12px; }
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>Service <strong>Status</strong></h1>
        <p class="subtitle">Real-time status monitoring via official status APIs</p>
        <button class="refresh-button" id="refreshBtn">‚Ü∫ Refresh Now</button>
        <div class="last-updated" id="lastUpdated">Loading...</div>
    </header>

    <div class="fetch-note">
        Status is pulled from each service's official API where CORS is supported. Services whose APIs block cross-origin requests fall back to reachability checks against the main domain ‚Äî those show as Operational if the site responds, but can't reflect actual incident data. For those, check the linked status page directly.
    </div>

    <div id="statsContainer" class="stats"></div>
    <div id="categoriesContainer" class="categories"></div>
</div>

<script>
/**
 * Strategy:
 *
 * Most major services use Atlassian Statuspage, which exposes:
 *   GET https://<domain>/api/v2/status.json
 *   Response: { status: { indicator: "none"|"minor"|"major"|"critical" } }
 *
 * We map those to: working / issues / down
 *
 * Services that DON'T use Statuspage get a direct page fetch (no-cors, reachability only).
 * For those we note that status is "reachable" not "operational" from their own reporting.
 *
 * indicator mapping:
 *   none       ‚Üí working
 *   minor      ‚Üí issues
 *   major      ‚Üí issues
 *   critical   ‚Üí down
 *   unreachable‚Üí down
 */

const services = {
    'Hosting & ISP': [
        {
            name: 'Cloudflare',
            statusApi: 'https://www.cloudflarestatus.com/api/v2/status.json',
            url: 'https://www.cloudflarestatus.com/'
        },
        {
            name: 'Calix Cloud',
            statusApi: 'https://trust.calix.com/api/v2/status.json',
            url: 'https://trust.calix.com/'
        },
        {
            name: 'Genesys',
            statusApi: 'https://status.mypurecloud.com/api/v2/status.json',
            url: 'https://status.mypurecloud.com/'
        }
    ],
    'Streaming': [
        {
            name: 'Amazon Web Services',
            statusApi: 'https://health.aws.amazon.com/public/currentevents', // not Statuspage ‚Äî reachability
            url: 'https://status.aws.amazon.com/',
            fallbackOnly: true
        },
        {
            name: 'Twitch',
            url: 'https://twitch.tv',
            fallbackOnly: true,
            note: 'Status API does not support CORS'
        },
        {
            name: 'Apple Services',
            url: 'https://www.apple.com/support/systemstatus/',
            fallbackOnly: true,
            note: 'Apple has no public JSON status API'
        },
        {
            name: 'Netflix',
            url: 'https://help.netflix.com/en/is-netflix-down',
            fallbackOnly: true,
            note: 'Netflix has no public status API'
        }
    ],
    'Gaming': [
        {
            name: 'PlayStation Network',
            url: 'https://www.playstation.com',
            fallbackOnly: true,
            note: 'Status API does not support CORS'
        },
        {
            name: 'Xbox Live',
            url: 'https://support.xbox.com/en-US/xbox-live-status',
            fallbackOnly: true,
            note: 'Xbox uses a custom status page without a public JSON API'
        },
        {
            name: 'Epic Games / Fortnite',
            statusApi: 'https://status.epicgames.com/api/v2/status.json',
            url: 'https://status.epicgames.com/'
        },
        {
            name: 'Steam',
            url: 'https://steamstat.us/',
            fallbackOnly: true,
            note: 'steamstat.us is third-party; no official JSON endpoint'
        },
        {
            name: 'Activision',
            url: 'https://support.activision.com/onlineservices',
            fallbackOnly: true,
            note: 'No public status API'
        },
        {
            name: 'Nintendo Online',
            url: 'https://www.nintendo.co.jp/netinfo/en_GB/index.html',
            fallbackOnly: true,
            note: 'No public JSON API'
        }
    ],
    'Communication': [
        {
            name: 'Discord',
            statusApi: 'https://discordstatus.com/api/v2/status.json',
            url: 'https://discordstatus.com/'
        },
        {
            name: 'Zoom',
            url: 'https://zoom.us',
            fallbackOnly: true,
            note: 'Status API does not support CORS'
        },
        {
            name: 'Slack',
            url: 'https://slack.com',
            fallbackOnly: true,
            note: 'Status API does not support CORS'
        },
        {
            name: 'Google Workspace',
            url: 'https://www.google.com/appsstatus',
            fallbackOnly: true,
            note: 'Google uses a custom dashboard without a public JSON API'
        }
    ],
    'Social Media': [
        {
            name: 'Facebook / Meta',
            statusApi: 'https://www.metastatus.com/api/v2/status.json',
            url: 'https://www.metastatus.com/'
        },
        {
            name: 'Reddit',
            statusApi: 'https://www.redditstatus.com/api/v2/status.json',
            url: 'https://www.redditstatus.com/'
        },
        {
            name: 'LinkedIn',
            statusApi: 'https://linkedin.statuspage.io/api/v2/status.json',
            url: 'https://linkedin.statuspage.io/'
        },
        {
            name: 'X / Twitter',
            statusApi: 'https://api.twitterstat.us/api/v2/status.json',
            url: 'https://api.twitterstat.us/'
        },
        {
            name: 'Instagram',
            url: 'https://www.instagram.com/',
            fallbackOnly: true,
            note: 'No public status API separate from Meta'
        }
    ],
    'AI Services': [
        {
            name: 'Claude (Anthropic)',
            statusApi: 'https://status.anthropic.com/api/v2/status.json',
            url: 'https://status.anthropic.com/'
        },
        {
            name: 'ChatGPT / OpenAI',
            statusApi: 'https://status.openai.com/api/v2/status.json',
            url: 'https://status.openai.com/'
        },
        {
            name: 'Google Cloud / Gemini',
            statusApi: 'https://status.cloud.google.com/incidents.json',
            url: 'https://status.cloud.google.com/',
            googleFormat: true
        }
    ]
};

// Map Statuspage indicator to our three states
function indicatorToStatus(indicator) {
    if (!indicator || indicator === 'none') return 'working';
    if (indicator === 'critical') return 'down';
    return 'issues'; // minor, major, maintenance
}

// Slack returns a different schema
function parseSlack(data) {
    // { status: "ok" | "active" | "disruption" }
    const s = data && data.status;
    if (!s || s === 'ok') return 'working';
    if (s === 'active') return 'issues';
    return 'down';
}

// Google Cloud doesn't have a clean status.json; we look at open incidents
function parseGoogle(data) {
    if (!Array.isArray(data)) return 'working';
    const open = data.filter(i => !i.end);
    if (open.length === 0) return 'working';
    if (open.length <= 2) return 'issues';
    return 'down';
}

async function fetchStatus(service) {
    if (service.fallbackOnly) {
        // Reachability-only check via no-cors HEAD
        try {
            await fetch(service.url, { method: 'HEAD', mode: 'no-cors' });
            return { status: 'working', detail: service.note || 'Reachable (no API available)' };
        } catch {
            return { status: 'down', detail: 'Unreachable' };
        }
    }

    try {
        const res = await fetch(service.statusApi, {
            method: 'GET',
            headers: { 'Accept': 'application/json' },
            // no mode restriction ‚Äî these are public CORS-enabled APIs
        });

        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        if (service.slackFormat) {
            return { status: parseSlack(data), detail: data.status || '' };
        }

        if (service.googleFormat) {
            return { status: parseGoogle(data), detail: `${Array.isArray(data) ? data.filter(i=>!i.end).length : 0} open incidents` };
        }

        // Standard Statuspage format
        const indicator = data?.status?.indicator;
        const description = data?.status?.description || '';
        return { status: indicatorToStatus(indicator), detail: description };

    } catch (err) {
        // API fetch failed (CORS, network, etc.) ‚Äî fall back to reachability only.
        // We do NOT report 'issues' here because a failed API call tells us nothing
        // about service health ‚Äî it just means we couldn't reach the status endpoint.
        try {
            await fetch(service.url, { method: 'HEAD', mode: 'no-cors' });
            return { status: 'working', detail: 'Status API unavailable ‚Äî site is reachable' };
        } catch {
            return { status: 'down', detail: 'Unreachable' };
        }
    }
}

let statusData = {};

async function checkAllServices() {
    // Initialize all as checking
    statusData = {};
    for (const [cat, list] of Object.entries(services)) {
        statusData[cat] = {};
        for (const svc of list) {
            statusData[cat][svc.name] = { status: 'checking', detail: '' };
        }
    }
    renderUI();

    // Fan out all checks concurrently, update as each resolves
    const promises = [];
    for (const [cat, list] of Object.entries(services)) {
        for (const svc of list) {
            const p = fetchStatus(svc).then(result => {
                statusData[cat][svc.name] = result;
                renderUI();
            }).catch(() => {
                statusData[cat][svc.name] = { status: 'down', detail: 'Error' };
                renderUI();
            });
            promises.push(p);
        }
    }

    await Promise.allSettled(promises);
    updateTimestamp();
}

function renderUI() {
    renderStats();
    renderCategories();
}

function renderStats() {
    let working = 0, issues = 0, down = 0;
    for (const cat in statusData) {
        for (const svc in statusData[cat]) {
            const s = statusData[cat][svc].status;
            if (s === 'working') working++;
            else if (s === 'issues') issues++;
            else if (s === 'down') down++;
        }
    }

    document.getElementById('statsContainer').innerHTML = `
        <div class="stat-card">
            <div class="stat-number working">${working}</div>
            <div class="stat-label">Operational</div>
        </div>
        <div class="stat-card">
            <div class="stat-number issues">${issues}</div>
            <div class="stat-label">Issues</div>
        </div>
        <div class="stat-card">
            <div class="stat-number down">${down}</div>
            <div class="stat-label">Down</div>
        </div>
    `;
}

function renderCategories() {
    const ICONS = {
        'Hosting & ISP': 'üèóÔ∏è',
        'Streaming':     'üì∫',
        'Gaming':        'üéÆ',
        'Communication': 'üí¨',
        'Social Media':  'üåê',
        'AI Services':   'ü§ñ'
    };

    let html = '';
    for (const [cat, list] of Object.entries(services)) {
        const icon = ICONS[cat] || 'üìã';
        html += `<div class="category"><div class="category-title">${icon}&nbsp; ${cat}</div>`;
        for (const svc of list) {
            const data = statusData[cat]?.[svc.name] || { status: 'checking', detail: '' };
            const { status, detail } = data;
            const label = status === 'working' ? 'Operational'
                        : status === 'issues'  ? 'Issues'
                        : status === 'down'    ? 'Down'
                        : 'Checking...';
            html += `
                <a class="service" href="${svc.url}" target="_blank" rel="noopener">
                    <div class="status-bar ${status}"></div>
                    <div class="service-info">
                        <div class="service-name">${svc.name}</div>
                        ${detail ? `<div class="service-detail">${detail}</div>` : ''}
                    </div>
                    <span class="status-text ${status}">${label}</span>
                </a>
            `;
        }
        html += `</div>`;
    }
    document.getElementById('categoriesContainer').innerHTML = html;
}

function updateTimestamp() {
    const now = new Date();
    document.getElementById('lastUpdated').textContent =
        `Last checked: ${now.toLocaleDateString()} at ${now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit',second:'2-digit'})}`;
}

document.getElementById('refreshBtn').addEventListener('click', async () => {
    const btn = document.getElementById('refreshBtn');
    btn.classList.add('loading');
    btn.disabled = true;
    btn.textContent = 'Checking...';
    await checkAllServices();
    btn.classList.remove('loading');
    btn.disabled = false;
    btn.textContent = '‚Ü∫ Refresh Now';
});

checkAllServices();
setInterval(checkAllServices, 5 * 60 * 1000);
</script>
</body>
</html>
